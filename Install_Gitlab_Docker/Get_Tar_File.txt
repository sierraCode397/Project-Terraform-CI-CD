sudo docker stop gitlab

sudo tar -czvf gitlab-backup.tar.gz -C /srv/gitlab .

# Transfer the tar file to another instance "Optional"

scp -i your-key.pem gitlab-backup.tar.gz ec2-user@<NEW_INSTANCE_IP>:~/

#  Using scp to download the file (Secure Copy via SSH) â€“ Recommended

scp -i vockey.pem ubuntu@<IP of your instance>:/home/ubuntu/gitlab-backup.tar.gz ~/Descargas/

"{
Replace your-key.pem with your SSH key file.
Replace <AWS_INSTANCE_IP> with your AWS instance's public IP.
~/Downloads/ is the destination folder on your local machine. You can change it.
}"

#Send the file from your local machine to the VM EC2

scp -i vockey.pem ~/Descargas/gitlab-backup.tar.gz ubuntu@44.212.12.158:/home/ubuntu/

# Extract the backup on the new instance

"Make sure that the /srv/gitlab/ directory exist"

sudo mkdir -p /srv/gitlab/

sudo chown -R $USER:$USER /srv/gitlab

sudo tar -xzvf gitlab-backup.tar.gz -C /srv/gitlab

# Adjust Permissions

sudo chown -R $USER:$USER /srv/gitlab/config /srv/gitlab/logs /srv/gitlab/data
sudo chmod -R 755 /srv/gitlab/config /srv/gitlab/logs /srv/gitlab/data

# Start the GitLab container on the new instance

sudo docker compose -f /srv/gitlab/docker-compose.yml up -d


Pasar la base de datos a un contenedor serverles en RDS AWS
